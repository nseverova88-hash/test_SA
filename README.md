# Задание 1: Анализ требований

## Описание:
#### Вам попал на руки фрагмент технического задания на разработку функционала "Корзина" для интернет-магазина "Петрушка Зеленая". В ТЗ есть несколько логических противоречий, недочетов и неполных мест.

Раздел ТЗ: Функционал корзины

1. Пользователь может добавить в корзину от 1 до 10 единиц одного товара.
2. Пользователь может изменить количество каждого товара в корзине не менее, чем до 1-го. Для удаления товара из корзины используется отдельная кнопка.
3. В корзине может находиться не более 5 различных товаров.
4. Суммарное количество всех товаров в корзине не может превышать 20 штук.
5. Товары в корзине могут быть разные.
6. При попытке добавить товар, превышающий лимиты, система показывает сообщение: "Лимит корзины превышен".
7. Цена на продукт фиксируется на момент добавления в корзину и не меняется.
8. На странице корзины отображается список товаров, их количество, цена за единицу и общая стоимость позиции.
9. Если пользователь уменьшает количество товара до 0, товар удаляется из корзины.
10. В корзине может быть реклама других продуктов.
11. Реклама товаров в корзине должна быть каждый будний день по утрам и вечерам.
13. Если цена на товар изменилась в каталоге, система должна автоматически обновить ее в корзине у всех пользователей.

## Что нужно сделать:
#### 1. Найдите и перечислите все логические противоречия и недочеты в предоставленном ТЗ. Объясните, в чем заключается проблема для каждого пункта.

- В п. 1 не понятно 10 единиц можно добавить или уже нет
- Второй пункт имеет смысл перефразировать, для лучшего понимания.
- Далее изменила порядок пунктов, сделала более логичным. Раз мы сперва начали говорить про единицы, нужно про них и продолжать. Поэтому был добавлен п. 3 и 4, где сказано до каких значений можно уменьшать/- - увеличивать количество единиц товара и что произойдет с кнопкой при достижении этих значений.
- В п. 5 добавлено уточнение для избежания двойного толкования.
- В п. 6 добавлено уточнение для избежания двойного толкования.
- П. 7 переделан, добавлено уточнение, для четкого понимания свыше какого количества система выдает ошибку превышения лимитов.
- Полностью изменен смысл п. 8 про изменение цены в каталоге и корзине, так как он противоречил п. 13, который был удален.
- В п. 9 добавлено уточнение про общую стоимость товаров в корзине (этот пункт не является критичным его хорошо бы обсудить с продукт-менеджером)
- В п. 10 добавлено уточнение, для понимания, что реклама может отображать, а может и нет.
- В п. 11 добавлено уточнение в какой период должна отображаться реклама в блоке, потому что утро и вечер для всех понятия разные.
- п. 12 полностью отсутствовал
- п. 13 полностью удален, так как противоречил п. 8

#### 2. Предложите конкретные исправления для устранения этих противоречий - напишите свою версию этого фрагмента ТЗ, которая должна быть логически завершенной и непротиворечивой: 
1. Пользователь может добавить в корзину от 1 до 10 единиц одного товара включительно.
2. Пользователь может максимально сократить количество каждого товара в корзине до 1-го. Для удаления товара из корзины используется отдельная кнопка.
3. Кнопка уменьшения количества товаров после достижения 1-го пропадает и не отображается пока количество единиц товаров не достигнет 2-х. 
4. Кнопка увеличения количества товаров после достижения 10 (включительно) пропадает и не отображается пока количество единиц товаров не достигнет 9. 
5. В корзине одновременно может находиться не более 5 различных позиций товаров.
6. Суммарное количество всех единиц товаров в корзине, присутствующих одновременно не может превышать 20 штук.
7. При попытке добавить 6-ю позицию товара, система показывает сообщение: "Лимит корзины превышен".
8. Цена на продукт фиксируется на момент добавления в корзину и не меняется при изменении цены в каталоге.
9. На странице корзины отображается список товаров, их количество, цена за единицу, общая стоимость позиции и общая сумма для оплаты всех товаров.
10. В корзине присутствует рекламный блок, в котором может отображаться реклама сторонних товаров.
11. Реклама товаров в корзине должна отображаться только в период с (ВРЕМЯ)  по (ВРЕМЯ) в будние дни.

#### 3. Какие уточняющие вопросы вы бы задали продукт-менеджеру или бизнес-заказчику по этому ТЗ?
- Можно ли добавить для отображения общую стоимость товаров в корзине или это уже описано просто в блоке который не попал в список данных требований?
- В какое время будет отображаться реклама в корзине? Учитывается ли часовой пояс, если это не местный сайт?
- Можно ли добавлять количество единиц товара цифрами или только через кнопки? Если можно то в качестве рекомендую заблокировать эту возможность, чтобы избежать лишних проверок.
- Правильно ли то что в корзину можно положить 10 единиц одного товара включительно?
- Все-таки присутствует ли кнопка удаления позиции (наименования) товара или удаляется путем убавления количества единиц?
- Что происходит когда меняется цена в каталоге? Изменяется она все-таки у пользователя в корзине? Или уже была зафиксирована в момент добавления в корзину?

# Задание 2: проектирование API

## Описание:
#### Интернет-магазин "Петрушка Зеленая" преуспевает, расширяется и в мобильном приложении решили создать новый экран, который будет отображать магазины партнеров (см. макеты ниже).
<img width="150" height="320" alt="image" src="https://github.com/user-attachments/assets/227b9777-c4d3-4060-aada-dcf521e2ea81" />

## Что нужно сделать:
#### 1. Написать пример REST API запроса, который будет вызываться при переходе пользователя на данный экран. 

REST API Запрос:
Должен возвращать список доступных магазинов-партнеров. Рекомендуется передавать координаты или идентификатор города пользователя, чтобы отображать актуальное время доставки.
###### Метод: GET</b>
###### Сервер: https://api.petrushka.ru/v1</b>
###### Эндпоинт: /partner-stores?location_id=1&limit=4
###### Где параметрами являются:
  - location_id: (string/строка) ID региона для расчета слотов доставки.
  - limit: (integer) количество магазинов на одной странице (для пагинации).
###### Заголовки:
  - Accept: application/json
  - Authorization: Bearer <user_token>

#### 2. Привести пример ответа этого REST API в соответствии с макетом. Формат - JSON. Учесть, что при клике на плашку магазина должен осуществляться переход по ссылке на внешний ресурс. 

###### Пример JSON ответа

Структура включает текстовые поля для отображения статуса доставки и поле external_url для перехода на сайт партнера.

<img width="452" height="862" alt="image" src="https://github.com/user-attachments/assets/0c294779-5bc1-4150-8ef8-04be7407599a" />

- id - идентификатор магазина в системе (в моем случае придумано, что взяли все первые магазины сети)
- brand - название магазина
- img_url - передаем лого магазина по ссылке
- delivery_info - сюда записываем подробную информацию о доставке (заголовок, время, нужно/не нужно выделять цветом)
- is_highlighted - введено для того, чтобы показать выделение цветом, в случае если необходимо (пример с ВкусВиллом)
- external_url - ссылка на внешний ресурс

# Задание 3: архитектура

## Описание:
Заказчик хочет, что в мобильное приложение интернет-магазина "Петрушка Зеленая" начали приходить пуши. Они могут быть разными: о том, что заказ слишком долго лежит без действий в корзине, об отмене заказа, рекламные рассылки и прочее. То есть нужен функционал, а какие пуши отправлять - точно найдется.

## Что нужно сделать:
Построить верхнеуровневую архитектурую схему - как должна работать отправка PUSH уведомлений в данном приложении. Можно просто в виде блок схем. Считаем, что на бэкенде микросервисная архитектура. В данном задании рекомендуется в интернете изучить архитектуры подобных решений.

<img width="366" height="481" alt="Диаграмма без названия drawio (2)" src="https://github.com/user-attachments/assets/dd684b9c-3d2f-4dfe-8aa7-94a1385d3df8" />

##### Основные компоненты системы:
1. Микросервисы: Триггерят уведомления только для своего сервиса. Они не знают как отправлять пуши, они просто кидают в очередь.
2. Шина данных (Message Broker): Брокер нужен для  ассинхронизации при передачи задач на отправку, чтобы не нагружать основные сервисы. А если внешние сервисы (Apple/Google/др) будут тормозить, это не "уронит" сервис заказов.
3. Notification Service (Ядро). Он: 
- Принимает событие.
- Идет в БД Токенов, чтобы найти push_token конкретного пользователя (уникальный ID устройства).
- Формирует текст сообщения (шаблонизатор).
- Определяет платформу (iOS или Android).
4. Внешниe провайдеры (Push Gateways FCM/APNs/Huawei/RuStore): Облачные сервисы, которые отправляют уведомления на устройство клиента.
5. БД Токенов: Хранит связку user_id <-> device_token. Обновляется каждый раз, когда пользователь заходит в мобильное приложение.

##### Почему это удобно для «Петрушки Зеленой»

- Масштабируемость: Если маркетологи решат отправить 1 000 000 пушей, Notification Service обработает их из очереди постепенно, не «уронив» базу данных заказов.
- Гибкость: Легко добавить новые типы уведомлений (например, о приезде курьера), просто добавив новый шаблон.
- Отказоустойчивость: Если сервис Apple временно недоступен, сообщение останется в очереди и будет отправлено позже (Retry policy).

